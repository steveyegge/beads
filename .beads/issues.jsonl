{"id":"bd-06276f","title":"Cleanup: pearl (false positive - branch pushed)","description":"Polecat: pearl\nBranch: polecat/pearl/bd-hdzi@mklra1ie\nCommit: 3c4391d1 (VERIFIED pushed to origin)\nIssue: bd-hdzi (closed)\nMR: gt-n7zg (created)\n\nPROBLEM: gt polecat remove failed with 'unpushed commits' error, but manual verification confirms branch IS pushed. Same bug as quartz (gt-suj/gt-8ba).\n\nRESOLUTION: Manually remove worktree:\nrm -rf /home/ubuntu/gastown9/beads/polecats/pearl\n\nSafe to remove - all work pushed and MR submitted.","status":"open","priority":3,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T23:04:53Z","created_by":"beads/witness","updated_at":"2026-01-19T23:04:53Z","labels":["bug:gt-suj","cleanup","polecat:pearl"]}
{"id":"bd-0b0eea","title":"BD doctor Dolt backend support","status":"closed","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T01:26:19Z","created_by":"mayor","updated_at":"2026-01-20T01:34:14Z","closed_at":"2026-01-20T01:34:14Z","close_reason":"Implemented Dolt backend support in bd doctor (commit 1638e3ae)","labels":["doctor","dolt","enhancement"]}
{"id":"bd-0b0eea.1","title":"Add backend detection helper to bd doctor","status":"closed","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T01:27:05Z","created_by":"mayor","updated_at":"2026-01-20T01:34:14Z","closed_at":"2026-01-20T01:34:14Z","close_reason":"Implemented in dolt.go","labels":["doctor","dolt"],"dependencies":[{"issue_id":"bd-0b0eea.1","depends_on_id":"bd-0b0eea","type":"parent-child","created_at":"2026-01-20T01:27:05Z","created_by":"mayor"}]}
{"id":"bd-0b0eea.2","title":"Skip SQLite-specific checks when backend is Dolt","status":"closed","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T01:27:06Z","created_by":"mayor","updated_at":"2026-01-20T01:34:15Z","closed_at":"2026-01-20T01:34:15Z","close_reason":"Implemented in database.go, integrity.go","labels":["doctor","dolt"],"dependencies":[{"issue_id":"bd-0b0eea.2","depends_on_id":"bd-0b0eea","type":"parent-child","created_at":"2026-01-20T01:27:06Z","created_by":"mayor"}]}
{"id":"bd-0b0eea.3","title":"Add Dolt-specific health checks","status":"closed","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T01:27:06Z","created_by":"mayor","updated_at":"2026-01-20T01:34:15Z","closed_at":"2026-01-20T01:34:15Z","close_reason":"Implemented in dolt.go","labels":["doctor","dolt"],"dependencies":[{"issue_id":"bd-0b0eea.3","depends_on_id":"bd-0b0eea","type":"parent-child","created_at":"2026-01-20T01:27:06Z","created_by":"mayor"}]}
{"id":"bd-0ybx","title":"Digest: mol-refinery-patrol","description":"Patrol: merged 1 branch (obsidian/bd-htl), filed 5 tracking beads for pre-existing test failures, no conflicts","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-19T21:52:01Z","updated_at":"2026-01-19T21:52:01Z","closed_at":"2026-01-19T21:52:01Z","close_reason":"Squashed from 11 wisps"}
{"id":"bd-1825ee","title":"Sync gastown from steveyegge upstream","description":"dispatched_by: mayor\n\nRun the gastown-upstream-sync formula to:\n1. Pull latest changes from steveyegge/gastown upstream\n2. Integrate into groblegark main branch\n3. Build the gt binary\n4. Install to ~/.local/bin/gt\n\nFormula: gastown-upstream-sync\n\nRepository: /home/ubuntu/groblegark-gastown","status":"closed","priority":1,"issue_type":"task","assignee":"beads/crew/upstream_syncer","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T00:22:02Z","created_by":"mayor","updated_at":"2026-01-20T00:25:03Z","closed_at":"2026-01-20T00:25:03Z","close_reason":"Closed"}
{"id":"bd-1a2d95","title":"TestCompleteCommandWorksWithoutDatabase fails - expects 0 completions, gets 58","description":"Pre-existing test failure detected during merge queue processing.\n\n**Test**: TestCompleteCommandWorksWithoutDatabase in cmd/bd/completions_test.go:265\n**Error**: Expected 0 completions without database, got 58\n**Impact**: Test suite fails but functionality may be working correctly\n\nThe test expects zero completions when no database exists, but the completion system is returning 58 results. This could be:\n1. Test environment pollution\n2. Recent behavior change not reflected in test expectations\n3. Completions now include non-database items (commands, flags, etc.)\n\nDiscovered during refinery patrol processing branch polecat/quartz/hq-184c6a@mklxo9fk","status":"open","priority":1,"issue_type":"bug","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T02:02:45Z","created_by":"beads/refinery","updated_at":"2026-01-20T02:02:45Z"}
{"id":"bd-23f570","title":"Test issue for debugging","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T22:43:32Z","created_by":"mayor","updated_at":"2026-01-19T22:43:32Z"}
{"id":"bd-28b703","title":"Test polecat routing","description":"dispatched_by: mayor","status":"hooked","priority":2,"issue_type":"task","assignee":"beads/polecats/jasper","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T01:58:30Z","created_by":"mayor","updated_at":"2026-01-20T02:00:49Z"}
{"id":"bd-2f95f5","title":"Fix agent routing tests","status":"closed","priority":2,"issue_type":"merge-request","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T22:44:53Z","created_by":"beads/polecats/topaz","updated_at":"2026-01-19T22:50:57Z","closed_at":"2026-01-19T22:50:57Z","close_reason":"Closed","labels":["gt:merge-request"]}
{"id":"bd-39qo","title":"Fix TestFindBeadsRepoRoot - not_in_repo case","description":"findBeadsRepoRoot returns /tmp instead of empty string when not in repo","status":"hooked","priority":1,"issue_type":"bug","assignee":"beads/polecats/onyx","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T21:50:36Z","created_by":"beads/refinery","updated_at":"2026-01-19T22:04:20Z"}
{"id":"bd-4ioj","title":"Fix TestFindBeadsRepoRoot","description":"Skip /tmp in repo root detection","status":"closed","priority":2,"issue_type":"merge-request","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T22:11:41Z","created_by":"beads/polecats/onyx","updated_at":"2026-01-19T22:34:50Z","closed_at":"2026-01-19T22:34:50Z","close_reason":"Closed","labels":["gt:merge-request"]}
{"id":"bd-5a9202","title":"Formula wisp creation fails with duplicate primary key error","description":"When attempting to create wisps from formulas, the process fails with a Dolt duplicate primary key error.\n\n## Symptoms:\n- gt sling \u003cformula\u003e \u003crig\u003e fails during wisp creation\n- Error: 'Error 1062: duplicate primary key given: []'\n- Occurs for both gastown-upstream-sync and other workflow formulas\n- Error happens at the first step of wisp instantiation\n\n## Reproduction:\n1. gt sling gastown-upstream-sync gastown --create\n2. Observe error during 'Creating wisp...' phase\n3. Error: failed to create issue from gastown-upstream-sync.\u003cstep-id\u003e\n\n## Observed:\n- Formula validates successfully (bd formula show works)\n- Cooking formula works (bd cook returns JSON)\n- Wisp creation consistently fails with duplicate key error\n- No existing beads found with conflicting IDs (bd list shows none)\n\n## Impact:\n- Cannot use formula-based workflows\n- Must create work beads and instructions manually\n- Blocks automated formula dispatch to polecats\n\n## Related:\n- bd-ab958e: Polecat redirect file issue (fixed)\n- Convoy JSON parsing errors (may be related Dolt issue)\n\nDiscovered while attempting to spawn polecat for gastown-upstream-sync formula execution.","status":"open","priority":2,"issue_type":"bug","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T00:56:52Z","created_by":"beads/crew/upstream_syncer","updated_at":"2026-01-20T00:56:52Z"}
{"id":"bd-6bnf","title":"Fix TestCompleteCommandWorksWithoutDatabase","description":"Expected 0 completions without database, got 58","status":"hooked","priority":1,"issue_type":"bug","assignee":"beads/polecats/opal","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T21:50:35Z","created_by":"beads/refinery","updated_at":"2026-01-19T22:04:38Z"}
{"id":"bd-6qgj","title":"Fix TestMergeDriverWithLockedConfig_E2E","description":"Expected error when git config is read-only, but no error was raised","status":"closed","priority":1,"issue_type":"bug","assignee":"beads/polecats/quartz","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T21:50:40Z","created_by":"beads/refinery","updated_at":"2026-01-19T22:05:36Z","closed_at":"2026-01-19T22:05:36Z","close_reason":"Fixed test by making .git directory read-only instead of just config file. Git uses atomic writes with rename(), so directory permissions matter."}
{"id":"bd-70jp","title":"Cleanup: quartz (false positive - branch pushed)","description":"Polecat: quartz\nBranch: polecat/quartz/bd-6qgj@mklpp8v6  \nCommit: ad242318 (VERIFIED pushed to origin)\nIssue: bd-6qgj (closed)\nMR: bd-vbeu (in queue)\n\nPROBLEM: gt polecat remove failed with 'unpushed commits' error, but manual verification confirms branch IS pushed. This is the known bug where removal checks against origin/main instead of feature branch remote.\n\nRESOLUTION: Manually remove worktree:\nrm -rf /home/ubuntu/gastown9/beads/polecats/quartz\n\nSafe to remove - all work pushed and MR submitted.","status":"open","priority":3,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T22:09:59Z","created_by":"beads/witness","updated_at":"2026-01-19T22:09:59Z","labels":["bug:gt-suj","cleanup","polecat:quartz"]}
{"id":"bd-74m","title":"Digest: mol-witness-patrol","description":"Patrol cycle 2: beads/obsidian iterating on lock tests (test failures, debugging). Refinery running. No cleanup. Inbox empty.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-19T20:52:29Z","updated_at":"2026-01-19T20:52:29Z","closed_at":"2026-01-19T20:52:29Z","close_reason":"Squashed from 10 wisps"}
{"id":"bd-757398","title":"Debug MR label test 1768863294","status":"closed","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T22:54:54Z","created_by":"beads/polecats/pearl","updated_at":"2026-01-19T22:55:38Z","closed_at":"2026-01-19T22:55:38Z","close_reason":"Closed","labels":["gt:merge-request"]}
{"id":"bd-7dh","title":"Refinery Patrol","description":"Merge queue processor patrol loop with verification gates.","status":"open","priority":2,"issue_type":"molecule","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T20:45:09Z","created_by":"mayor","updated_at":"2026-01-19T20:45:09Z"}
{"id":"bd-7iy","title":"Digest: mol-witness-patrol","description":"Patrol 7: obsidian session healthy, awaiting push instruction","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-19T20:55:10Z","updated_at":"2026-01-19T20:55:10Z","closed_at":"2026-01-19T20:55:10Z","close_reason":"Squashed from 10 wisps"}
{"id":"bd-7o5a","title":"Digest: mol-refinery-patrol","description":"Patrol: merged 1 branch (bd-4ioj/onyx: TestFindBeadsRepoRoot fix)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-19T22:35:23Z","updated_at":"2026-01-19T22:35:23Z","closed_at":"2026-01-19T22:35:23Z","close_reason":"Squashed from 11 wisps"}
{"id":"bd-8455db","title":"Test maintainer role","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T01:55:55Z","created_by":"mayor","updated_at":"2026-01-20T01:55:55Z"}
{"id":"bd-994","title":"Digest: mol-witness-patrol","description":"Patrol 5: obsidian committed lock tests (bd-htl), all tests passing","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-19T20:54:07Z","updated_at":"2026-01-19T20:54:07Z","closed_at":"2026-01-19T20:54:07Z","close_reason":"Squashed from 10 wisps"}
{"id":"bd-9um","title":"Add Dolt lock and timeout tests","status":"closed","priority":2,"issue_type":"merge-request","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T20:57:30Z","created_by":"beads/polecats/obsidian","updated_at":"2026-01-19T22:12:30Z","closed_at":"2026-01-19T22:12:30Z","close_reason":"Duplicate of bd-htl, already merged in 5c27a055","labels":["gt:merge-request"]}
{"id":"bd-a772fe","title":"Debug label syntax 3 1768863320","status":"closed","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T22:55:21Z","created_by":"beads/polecats/pearl","updated_at":"2026-01-19T22:55:38Z","closed_at":"2026-01-19T22:55:38Z","close_reason":"Closed","labels":["gt:test-label"]}
{"id":"bd-ab958e","title":"Beads rig polecats lack Dolt database initialization","description":"When spawning polecats in the beads rig, the .beads directory is not properly initialized with a redirect file to the shared Dolt database.\n\n## Root Cause Discovery:\nBeads rig uses a shared database at ~/gt/beads/mayor/rig/.beads/. Polecats in the beads rig need a redirect file at .beads/redirect pointing to this shared database.\n\nWorking polecat example (garnet):\n- Has file: beads/polecats/garnet/beads/.beads/redirect\n- Content: ../../../mayor/rig/.beads\n\nFailed polecat (opal):\n- Missing: beads/polecats/opal/beads/.beads/redirect\n- Result: read-only database errors, wisp creation failures\n\n## Symptoms:\n- gt sling to beads rig spawns polecat successfully\n- Polecat workspace created with beads repo clone\n- .beads/issues.jsonl.new exists but no redirect file\n- Operations fail with: 'cannot update manifest: database is read only'\n- Formula wisp creation fails with: 'Error 1062: duplicate primary key given: []'\n\n## Fix Needed:\nPolecat spawn logic should create .beads/redirect file pointing to the rig's shared beads database when spawning in the beads rig (or any rig using shared database).\n\nDiscovered while testing gastown-upstream-sync formula execution in bd-1825ee.","status":"open","priority":2,"issue_type":"bug","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T00:42:14Z","created_by":"beads/crew/upstream_syncer","updated_at":"2026-01-20T00:43:07Z"}
{"id":"bd-b16277","title":"Execute gastown-upstream-sync workflow","description":"dispatched_by: beads/crew/upstream_syncer\n\nExecute the gastown-upstream-sync workflow:\n\n1. Navigate to /home/ubuntu/gastown (NOT groblegark-gastown - that path doesn't exist)\n2. Fetch from steveyegge/gastown upstream (upstream remote already configured)\n3. Merge upstream/main into groblegark main\n4. Build the gt binary: go build -o gt cmd/gt/main.go\n5. Run tests: go test ./...\n6. Install to ~/.local/bin/gt (replace existing binary)\n7. Push to groblegark origin\n8. Verify installation with gt version\n\nThe repository is at /home/ubuntu/gastown with:\n- origin: https://github.com/groblegark/gastown.git\n- upstream: https://github.com/steveyegge/gastown.git","status":"hooked","priority":2,"issue_type":"task","assignee":"beads/polecats/obsidian","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T00:28:39Z","created_by":"beads/crew/upstream_syncer","updated_at":"2026-01-20T00:44:00Z"}
{"id":"bd-beads-crew-bugfix","title":"Crew worker bugfix in beads rig","description":"Crew worker responsible for investigating and fixing bugs in the beads system.\n\nInitial focus: Dolt duplicate primary key errors in molecule/wisp creation.\n\nResponsibilities:\n- Investigate and fix database-related bugs\n- Handle Dolt-specific error scenarios\n- Improve error handling and recovery","status":"open","priority":2,"issue_type":"agent","assignee":"beads/crew/bugfix","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T00:29:47Z","created_by":"beads/polecats/ruby","updated_at":"2026-01-20T00:29:47Z","labels":["gt:agent","role_type:crew"],"role_type":"crew"}
{"id":"bd-beads-crew-upstream_syncer","title":"Crew worker upstream_syncer in beads rig","description":"Crew worker responsible for syncing upstream repositories into groblegark forks.\n\nowned_formulas: gastown-upstream-sync\n\nAs owner of the gastown-upstream-sync formula, responsibilities include:\n- Monitoring execution quality when the formula is run\n- Iterating and improving the formula based on feedback\n- Keeping the formula healthy and up-to-date","status":"open","priority":2,"issue_type":"agent","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T00:26:19Z","created_by":"beads/crew/upstream_syncer","updated_at":"2026-01-20T00:26:26Z","labels":["gt:agent"]}
{"id":"bd-beads-polecat-jasper","title":"Polecat jasper","description":"Polecat jasper\n\nrole_type: \nrig: null\nagent_state: \nhook_bead: null\nrole_bead: null\ncleanup_status: clean\nactive_mr: bd-0aad0b\nnotification_level: null\nowned_formulas: null","status":"open","priority":2,"issue_type":"agent","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T02:01:39Z","created_by":"mayor","updated_at":"2026-01-20T02:07:32Z","role_type":"polecat","rig":"beads/polecats/jasper"}
{"id":"bd-beads-polecat-quartz","title":"Polecat quartz","description":"Polecat quartz\n\nrole_type: \nrig: null\nagent_state: \nhook_bead: null\nrole_bead: null\ncleanup_status: has_unpushed\nactive_mr: bd-a37fca\nnotification_level: null\nowned_formulas: null","status":"open","priority":2,"issue_type":"agent","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T01:59:39Z","created_by":"mayor","updated_at":"2026-01-20T02:00:03Z","pinned":true,"role_type":"polecat","rig":"beads/polecats/quartz"}
{"id":"bd-bf21d6","title":"Fix Dolt duplicate primary key error in molecule/wisp creation","description":"**Problem:**\nWhen creating molecules or wisps, getting \"Error 1062: duplicate primary key given: []\" from Dolt.\n\n**Error messages:**\n```\nError pouring proto: failed to create issue from gastown-upstream-sync.check-repo-location: Error 1062: duplicate primary key given: []\n\nError creating wisp: failed to create issue from gastown-upstream-sync.check-repo-location: Error 1062: duplicate primary key given: []\n```\n\n**Context:**\n- Happens with gastown-upstream-sync molecule\n- Error 1062 is MySQL/Dolt error code for duplicate entry for key\n- Empty brackets [] suggest the error message isn't capturing the duplicate key value\n- Likely an issue with how molecule steps create child issues\n\n**Investigation needed:**\n1. Check if issues with IDs like gastown-upstream-sync.check-repo-location already exist\n2. Determine if molecule is trying to recreate existing issues\n3. Look at internal/molecules code for issue creation logic\n4. Check if this is Dolt-specific (primary key handling difference from SQLite)\n\n**Files to check:**\n- internal/molecules/molecules.go - molecule execution\n- internal/storage/dolt/issues.go - Dolt issue creation\n- cmd/bd/mol.go - molecule commands\n\n**Impact:** P0 - blocking molecule/wisp workflows","status":"closed","priority":0,"issue_type":"bug","assignee":"beads/crew/bugfix","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T00:30:06Z","created_by":"beads/polecats/ruby","updated_at":"2026-01-20T01:46:28Z","closed_at":"2026-01-20T01:46:28Z","close_reason":"Fixed with idempotent create in Dolt storage (commit 79e22771)","labels":["backend","dolt","molecules"],"comments":[{"id":1,"issue_id":"bd-bf21d6","author":"beads/polecats/ruby","text":"**Investigation findings:**\n\nThe error \"Error 1062: duplicate primary key given: []\" is coming from Dolt during INSERT operations in insertIssue() function (internal/storage/dolt/issues.go:368-409).\n\n**Root cause:**\nThe empty brackets [] suggest that the error message isn't properly capturing the duplicate key value from the Dolt error. This makes it impossible to debug which key is actually duplicate.\n\n**Code locations:**\n- insertIssue() at internal/storage/dolt/issues.go:368\n- insertIssueTx() at internal/storage/dolt/transaction.go:245\n\n**Next steps:**\n1. Add better error wrapping to capture the actual duplicate key from Dolt error\n2. Check if the issue already exists before attempting INSERT (defensive check)\n3. Consider using INSERT IGNORE or ON DUPLICATE KEY UPDATE for idempotency\n4. Add logging to show which issue ID is being inserted when the error occurs\n\n**Testing needed:**\n- Try to reproduce the error with gastown-upstream-sync molecule\n- Check if this is a race condition (multiple attempts to create same issue)\n- Verify if Dolt's error message format differs from MySQL","created_at":"2026-01-20T00:31:08Z"}]}
{"id":"bd-c76d1c","title":"Test from polecat pearl","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T22:46:15Z","created_by":"mayor","updated_at":"2026-01-19T22:46:15Z"}
{"id":"bd-d7b931","title":"Dolt LOCK file persists causing 'database is read only' errors","description":"The Dolt noms/LOCK file keeps getting recreated after any dolt operation, causing subsequent bd commands to fail with 'cannot update manifest: database is read only'. \n\n**Symptoms:**\n- bd create/list/update fails with: `cannot update manifest: database is read only`\n- LOCK file at .beads/dolt/beads/.dolt/noms/LOCK must be manually deleted\n- Recurs after any dolt sql command or bd operation\n\n**Workaround:**\n- `rm -f .beads/dolt/beads/.dolt/noms/LOCK` before bd commands\n\n**Root Cause Investigation Needed:**\n- Why is LOCK file not being released after operations?\n- Possibly related to daemon/process management","notes":"Fix implemented: cleanupStaleDoltLock() added to store.go. Removes stale LOCK files older than 5 seconds on startup.","status":"closed","priority":1,"issue_type":"bug","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T02:02:31Z","created_by":"mayor","updated_at":"2026-01-20T02:07:45Z","closed_at":"2026-01-20T02:07:45Z"}
{"id":"bd-dcc1cb","title":"Debug label syntax test 1768863310","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T22:55:10Z","created_by":"beads/polecats/pearl","updated_at":"2026-01-19T22:55:10Z","labels":["gt:test-label"]}
{"id":"bd-dee249","title":"Foreign key violation (Error 1452) when adding dependencies during sling","description":"When running `gt sling`, adding tracking dependencies fails with foreign key violation.\n\n**Error:**\n```\nError: failed to add dependency: Error 1452: cannot add or update a child row - Foreign key violation on fk: `fk_dep_depends_on`, table: `dependencies`, referenced table: `issues`, key: `[external:bd-XXXX:bd-XXXX]`\nWarning: Could not add tracking relation: exit status 1\n```\n\n**Impact:**\n- Convoy tracking relations not established\n- Work slinging partially fails but continues\n\n**Possible Causes:**\n- Issue ID being referenced doesn't exist in HQ database\n- Cross-database foreign key reference (bd- prefix vs hq- prefix)\n- Timing issue with issue creation vs dependency creation","notes":"Fix: formatTrackBeadID was incorrectly parsing bead IDs. Changed SplitN from 3 to 2 to extract just the rig prefix (bd, gt, etc.) instead of combining first two segments.","status":"closed","priority":2,"issue_type":"bug","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T02:02:40Z","created_by":"mayor","updated_at":"2026-01-20T02:11:45Z","closed_at":"2026-01-20T02:11:45Z"}
{"id":"bd-eei","title":"Deacon Patrol","description":"Mayor's daemon patrol loop for handling callbacks, health checks, and cleanup.","status":"open","priority":2,"issue_type":"molecule","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T20:45:08Z","created_by":"mayor","updated_at":"2026-01-19T20:45:08Z"}
{"id":"bd-f3s","title":"Digest: mol-witness-patrol","description":"Patrol cycle 1: Inspected beads/obsidian (working on bd-htl, making progress). No cleanup wisps. Refinery idle, no MRs. Deacon not found (escalation failed - db read-only). Inbox empty.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-19T20:51:25Z","updated_at":"2026-01-19T20:51:25Z","closed_at":"2026-01-19T20:51:25Z","close_reason":"Squashed from 10 wisps"}
{"id":"bd-f5a134","title":"Polecat agent bead not auto-created or pinned during gt sling spawn","description":"When `gt sling` spawns a new polecat, the agent bead is not created or pinned, causing hook attachment to fail.\n\n**Errors during sling:**\n```\nWarning: couldn't set agent bd-beads-polecat-NAME hook: setting hook: issue not found\nWarning: Could not attach work molecule: ... issue bd-beads-polecat-NAME is not pinned (status: open)\n```\n\n**Impact:**\n- Polecats spawn but don't receive hooked work\n- Hook file not created in polecat's .beads directory\n- Work molecule not attached\n\n**Expected Behavior:**\n- gt sling should create `bd-RIGNAME-polecat-NAME` agent bead\n- Agent bead should be pinned\n- Hook should be set on agent bead\n\n**Workaround:**\n```bash\nbd create \"Polecat NAME\" --type agent --role-type polecat --agent-rig PATH --id bd-RIGNAME-polecat-NAME\ndolt sql -q \"UPDATE issues SET pinned = 1 WHERE id = 'bd-RIGNAME-polecat-NAME'\"\n```\n\n**Related:** bd-ab958e (Beads rig polecats lack Dolt database initialization)","status":"open","priority":1,"issue_type":"bug","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T02:02:50Z","created_by":"mayor","updated_at":"2026-01-20T02:02:50Z"}
{"id":"bd-fjl","title":"Digest: mol-witness-patrol","description":"Patrol 6: obsidian work complete (bd-htl), awaiting push","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-19T20:54:35Z","updated_at":"2026-01-19T20:54:35Z","closed_at":"2026-01-19T20:54:35Z","close_reason":"Squashed from 10 wisps"}
{"id":"bd-g9fg","title":"Add Dolt lock retry logic with exponential backoff","description":"**Problem:** No retry logic for Dolt lock contention. When lock can't be acquired, bd falls back to readonly mode causing 'database is read only' errors.\n\n**Difference:**\n- SQLite: Lock failure → wait/retry (busy_timeout pragma)\n- Dolt: Lock failure → open readonly → error on write\n\n**Solution:**\n1. Detect readonly/lock errors in Dolt operations\n2. Retry with exponential backoff when lock contention detected\n3. Add configurable retry limits (default: 30 retries = ~6s)\n4. Log lock contention for debugging\n\n**Implementation location:**\n- internal/storage/dolt/store.go - Add retry wrapper for db operations\n- internal/storage/factory/factory_dolt.go - Pass retry config\n\n**Impact:** P0 - blocking gt sling polecat spawning when lock contention occurs","status":"open","priority":0,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T22:37:14Z","created_by":"beads/polecats/ruby","updated_at":"2026-01-19T22:37:14Z","labels":["backend","dolt","enhancement"]}
{"id":"bd-hdzi","title":"gt done creates merge requests without gt:merge-request label","description":"dispatched_by: mayor\n\n## Problem\ngt done is creating merge request beads with type=merge-request but WITHOUT the gt:merge-request label, causing them to be invisible to 'gt mq list'.\n\n## Evidence\n- bd-vbeu (broken): type=merge-request, no labels\n- bd-8gq (working): type=task, labels=[gt:merge-request]\n\n## Impact\nPolecats complete work and run gt done, but refinery can't see the MRs in the queue. Merge pipeline stalls.\n\n## Root Cause\ngt done command not adding required label when creating MR beads.\n\n## Fix Required\nUpdate gt done to add gt:merge-request label to all merge request beads it creates.","status":"closed","priority":0,"issue_type":"bug","assignee":"beads/polecats/pearl","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T22:10:51Z","created_by":"beads/refinery","updated_at":"2026-01-19T23:02:42Z","closed_at":"2026-01-19T23:02:42Z","close_reason":"Closed"}
{"id":"bd-htl","title":"Add Dolt lock retry and timeout tests","description":"dispatched_by: mayor\n\n**Goal**: Add tests for Dolt lock handling behavior identified as missing during bug investigation.\n\n**Background**: \nInvestigation of rig-2b9509 (database read-only error) revealed that Dolt's file-based locking (.dolt/noms/LOCK) can cause contention when multiple bd processes run concurrently. We need tests to verify proper handling of lock timeouts and retry logic.\n\n**Current Coverage**:\n- ✓ TestLongTransactionBlocking - Basic blocking behavior\n- ✓ TestHighContentionStress - High contention scenarios\n- ✗ Lock timeout configuration - NOT TESTED\n- ✗ Lock retry with backoff - NOT TESTED  \n- ✗ Read-only fallback behavior - NOT TESTED\n- ✗ Multi-process contention (subprocess spawning) - NOT TESTED\n\n**Tests to Add**:\n\n1. **TestDoltLockTimeout** - Verify --lock-timeout flag behavior\n   - One transaction holds lock for extended period\n   - Second transaction attempts write with timeout\n   - Verify timeout is respected (not infinite wait)\n   - Verify appropriate error message returned\n\n2. **TestDoltLockRetryWithBackoff** - Test retry logic (when implemented)\n   - First process holds lock briefly (2-3 seconds)\n   - Second process retries with exponential backoff\n   - Verify successful acquisition after lock release\n   - Verify backoff timing (1s, 2s, 4s, etc.)\n   - Verify gives up after max retries\n\n3. **TestDoltReadOnlyFallback** - Test read-only mode fallback\n   - Open store in read-only mode explicitly\n   - Verify read operations succeed (GetIssue, ListIssues)\n   - Verify write operations fail with clear error\n   - Verify no silent fallback to read-only on lock contention\n\n4. **TestDoltMultipleProcessContention** - Simulate real-world scenario\n   - Spawn multiple bd subprocesses (like witness patrol + gt mail)\n   - Each process attempts concurrent write operations\n   - Verify all processes eventually succeed or timeout gracefully\n   - No silent failures, no database corruption\n   - Measure p50/p95/p99 latency under contention\n\n5. **TestDoltConnectionPooling** - Test connection lifecycle\n   - Create store, perform operations, close store\n   - Verify .dolt/noms/LOCK is released after Close()\n   - Test with SetConnMaxLifetime(0) current behavior\n   - Verify concurrent stores don't deadlock on cleanup\n\n**Files to Modify**:\n- `internal/storage/dolt/concurrent_test.go` - Add new test cases\n- `internal/storage/dolt/lock_test.go` - New file for lock-specific tests\n- `internal/storage/dolt/store.go` - May need instrumentation for testing\n\n**Acceptance Criteria**:\n- All 5 new tests pass\n- Tests fail appropriately when bugs are reintroduced\n- Tests run in CI without flakes\n- Coverage report shows lock handling paths tested\n- Documentation updated with concurrency guarantees\n\n**References**:\n- rig-2b9509: Database read-only error investigation  \n- internal/storage/dolt/concurrent_test.go: Existing concurrency tests\n- internal/storage/dolt/store.go:123: SetMaxOpenConns(1) - single writer","status":"closed","priority":2,"issue_type":"task","assignee":"beads/polecats/obsidian","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T20:47:19Z","created_by":"mayor","updated_at":"2026-01-19T20:58:54Z","closed_at":"2026-01-19T20:58:54Z"}
{"id":"bd-i2nk","title":"Make bd doctor respect Dolt backend configuration","description":"**Problem:** bd doctor and other commands don't properly check/respect when a rig is configured to use Dolt backend instead of SQLite.\n\n**Where should backend be configured?**\n- metadata.json should have a \"backend\" field (\"sqlite\" or \"dolt\")\n- internal/configfile package should expose GetBackend() method\n- Commands like bd doctor should check backend and handle accordingly\n\n**Changes needed:**\n- Ensure metadata.json can specify backend type\n- Update bd doctor to detect and work with Dolt databases\n- Add validation that commands respect the configured backend\n\n**Source:** rig-358fc7 investigation","status":"closed","priority":0,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T22:37:03Z","created_by":"beads/polecats/ruby","updated_at":"2026-01-19T22:51:56Z","closed_at":"2026-01-19T22:51:56Z","close_reason":"Closed"}
{"id":"bd-iqvf","title":"Digest: mol-refinery-patrol","description":"Patrol: merged 2 branches (bd-vbeu/quartz: merge driver test, bd-k89l/jasper: agent ID validation), closed 1 duplicate (bd-9um)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-19T22:15:58Z","updated_at":"2026-01-19T22:15:58Z","closed_at":"2026-01-19T22:15:58Z","close_reason":"Squashed from 11 wisps"}
{"id":"bd-jf5","title":"Digest: mol-witness-patrol","description":"Patrol 3: beads/obsidian iterating (tests passing, debugging failures). Routine checks clean.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-19T20:53:16Z","updated_at":"2026-01-19T20:53:16Z","closed_at":"2026-01-19T20:53:16Z","close_reason":"Squashed from 10 wisps"}
{"id":"bd-k89l","title":"Fix TestValidateAgentID for witness and refinery","status":"closed","priority":2,"issue_type":"merge-request","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T22:08:06Z","created_by":"beads/polecats/jasper","updated_at":"2026-01-19T22:15:32Z","closed_at":"2026-01-19T22:15:32Z","close_reason":"Closed","labels":["gt:merge-request"]}
{"id":"bd-o3gt","title":"Audit and fix unnecessary write locks for read-only operations","description":"**Problem:** We may be acquiring write locks when only read operations are needed, causing unnecessary lock contention.\n\n**Investigation needed:**\n1. Check if read-only commands (list, show, ready, etc) properly use ReadOnly: true option\n2. Verify factory.NewFromConfig and factory.NewWithOptions respect read-only mode\n3. Audit Dolt New() - does it acquire write lock even in read-only mode?\n4. Check if schema init (initSchema) runs for read-only opens\n\n**Current read-only commands:**\n- list, ready, show, stats, blocked, count, search, graph, duplicates, comments\n\n**Files to check:**\n- internal/storage/dolt/store.go:149-154 (skips schema init if ReadOnly)\n- internal/storage/factory/factory.go (passes ReadOnly option)\n- cmd/bd/main.go:750 (useReadOnly flag)\n\n**Expected behavior:**\n- Read-only commands should NEVER acquire write locks\n- This reduces contention for multi-reader scenarios\n- Important for gt sling and other concurrent operations\n\n**Impact:** P0 - unnecessary lock contention blocking concurrent operations","status":"open","priority":0,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T22:37:24Z","created_by":"beads/polecats/ruby","updated_at":"2026-01-19T22:37:24Z","labels":["backend","dolt","performance"]}
{"id":"bd-sp1t","title":"Fix TestValidateAgentID for witness and refinery","description":"ValidateAgentID accepts 'gt-witness' and 'gt-refinery' without town prefix, should require full agent ID","status":"hooked","priority":1,"issue_type":"bug","assignee":"beads/polecats/jasper","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T21:50:38Z","created_by":"beads/refinery","updated_at":"2026-01-19T22:04:03Z"}
{"id":"bd-t92","title":"Digest: mol-witness-patrol","description":"Patrol 4: routine checks, beads/obsidian continues work","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-19T20:53:39Z","updated_at":"2026-01-19T20:53:39Z","closed_at":"2026-01-19T20:53:39Z","close_reason":"Squashed from 10 wisps"}
{"id":"bd-twr","title":"Witness Patrol","description":"Per-rig worker monitor patrol loop with progressive nudging.","status":"open","priority":2,"issue_type":"molecule","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T20:45:08Z","created_by":"mayor","updated_at":"2026-01-19T20:45:08Z"}
{"id":"bd-vbeu","title":"Fix TestMergeDriverWithLockedConfig_E2E by making .git dir read-only","description":"Git uses atomic writes with rename() to update config files, so making just the config file read-only doesn't prevent writes. The fix changes the test to make the .git directory read-only instead, which properly causes git config to fail with a permission error.\n\nCloses: bd-6qgj\n\nBranch: polecat/quartz/bd-6qgj@mklpp8v6","status":"closed","priority":2,"issue_type":"merge-request","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T22:07:41Z","created_by":"beads/polecats/quartz","updated_at":"2026-01-19T22:13:59Z","closed_at":"2026-01-19T22:13:59Z","close_reason":"Closed","labels":["gt:merge-request"]}
{"id":"bd-zr9m","title":"Fix agent routing tests (TestAgentStateWithRouting, TestAgentHeartbeatWithRouting, TestAgentShowWithRouting)","description":"These tests are failing because they cannot resolve test issue IDs. Need to investigate routing logic.","status":"hooked","priority":1,"issue_type":"bug","assignee":"beads/polecats/topaz","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T21:50:34Z","created_by":"beads/refinery","updated_at":"2026-01-19T22:04:56Z"}
{"id":"gt-03k","title":"Test","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T00:42:10Z","created_by":"beads/crew/dolt_fixer","updated_at":"2026-01-19T00:42:10Z"}
{"id":"gt-0dd","title":"End-to-end test","description":"Testing complete workflow.","status":"open","priority":1,"issue_type":"message","assignee":"mayor/","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T16:48:33Z","created_by":"gastown/polecats/furiosa","updated_at":"2026-01-19T16:48:33Z","labels":["from:gastown/polecats/furiosa","thread:thread-3e2e3b2d117a"]}
{"id":"gt-0tu","title":"Test2","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T08:41:22Z","created_by":"admin","updated_at":"2026-01-19T08:41:22Z"}
{"id":"gt-0x0","title":"Research cicd-templates and document troubleshooting","description":"Explore repo, document components, identify common failures, update formula","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-18T18:13:48Z","created_by":"mayor","updated_at":"2026-01-18T18:13:48Z"}
{"id":"gt-14c","title":"Merge failed: tests","description":"Your merge request failed.\n\nBranch: polecat/nux/gt-abc\nIssue: gt-abc\nFailure: tests\nError: Test failed\n\nPlease fix the issue and resubmit your work with 'gt done'.","status":"open","priority":1,"issue_type":"message","assignee":"gastown/nux","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T06:20:28Z","created_by":"gastown/witness","updated_at":"2026-01-19T06:20:28Z","labels":["from:gastown/witness","thread:thread-81de97c95d09"]}
{"id":"gt-16m","title":"Flaky test: TestMergeDriverWithLockedConfig_E2E fails on read-only git config check","status":"open","priority":2,"issue_type":"bug","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-17T07:09:19Z","created_by":"beads/refinery","updated_at":"2026-01-17T07:09:19Z"}
{"id":"gt-194","title":"Route test","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T08:44:21Z","created_by":"admin","updated_at":"2026-01-19T08:44:21Z"}
{"id":"gt-19u","title":"Test with gt9 prefix","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T08:47:39Z","created_by":"gastown/crew/gastown9_dolt","updated_at":"2026-01-19T08:47:39Z"}
{"id":"gt-1ea","title":"Work merged successfully","description":"Your work has been merged to main.\n\nBranch: polecat/nux/gt-abc\nIssue: gt-abc\nCommit: abc123\n\nThank you for your contribution! Your worktree will be cleaned up shortly.","status":"open","priority":2,"issue_type":"message","assignee":"gastown/nux","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-18T21:09:52Z","created_by":"gastown/witness","updated_at":"2026-01-18T21:09:52Z","labels":["from:gastown/witness","thread:thread-c2fdf5f9ef1b"]}
{"id":"gt-1il","title":"Rebase required - merge conflict","description":"Your branch has conflicts with main.\n\nBranch: polecat/nux/gt-abc\nIssue: gt-abc\n\nConflicting files:\n  - file1.go\n\nPlease rebase your changes:\n\n  git fetch origin\n  git rebase origin/main\n  # Resolve any conflicts\n  git push -f\n\nThen run 'gt done' to resubmit for merge.","status":"open","priority":1,"issue_type":"message","assignee":"gastown/nux","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-17T17:56:59Z","created_by":"gastown/witness","updated_at":"2026-01-17T17:56:59Z","labels":["from:gastown/witness","thread:thread-9982935705e3"]}
{"id":"gt-1jr6","title":"Routing test 2","description":"Debug routing","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T17:37:51Z","created_by":"gastown/crew/gastown9_dolt","updated_at":"2026-01-19T17:37:51Z"}
{"id":"gt-2s8","title":"External ref test","status":"open","priority":1,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-17T07:08:03Z","created_by":"beads/refinery","updated_at":"2026-01-17T07:08:03Z","external_ref":"https://example.com/spec.md"}
{"id":"gt-35se","title":"No ref test","status":"open","priority":1,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T22:08:13Z","created_by":"beads/polecats/opal","updated_at":"2026-01-19T22:08:13Z"}
{"id":"gt-3cv","title":"Force Dolt","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T08:48:30Z","created_by":"gastown/crew/gastown9_dolt","updated_at":"2026-01-19T08:48:30Z"}
{"id":"gt-3et","title":"Dolt backend test","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T08:39:29Z","created_by":"admin","updated_at":"2026-01-19T08:39:29Z"}
{"id":"gt-4ib","title":"Replace FIFO-based decision receiver with HTTP server","description":"Replace FIFOs with HTTP server for decision-point IPC. FIFOs cause Claude to hang/crash. HTTP is cleaner - no blocking, better timeouts, easier debugging.","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-18T17:35:39Z","created_by":"mayor","updated_at":"2026-01-18T17:35:39Z"}
{"id":"gt-4oh","title":"No ref test","status":"open","priority":1,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-17T07:12:36Z","created_by":"beads/refinery","updated_at":"2026-01-17T07:12:36Z"}
{"id":"gt-4pa","title":"Test after db rebuild","description":"Testing prefix","status":"open","priority":2,"issue_type":"message","assignee":"mayor/","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T16:56:55Z","created_by":"gastown/polecats/furiosa","updated_at":"2026-01-19T16:56:55Z"}
{"id":"gt-5bw","title":"Debug test 2","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T08:43:58Z","created_by":"admin","updated_at":"2026-01-19T08:43:58Z"}
{"id":"gt-5xn","title":"Test issue 1","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T00:12:05Z","created_by":"beads/refinery","updated_at":"2026-01-19T00:12:05Z"}
{"id":"gt-6q5","title":"Test issue","description":"Testing Dolt backend","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-18T22:31:16Z","created_by":"gastown/polecats/furiosa","updated_at":"2026-01-18T22:31:16Z"}
{"id":"gt-6t2s","title":"Test hq mail","description":"Testing that mail gets hq- prefix","status":"open","priority":1,"issue_type":"message","assignee":"mayor/","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T17:07:14Z","created_by":"gastown/crew/gastown9_dolt","updated_at":"2026-01-19T17:07:14Z","labels":["from:gastown/crew/gastown9_dolt","thread:thread-4ddeae3855bb"]}
{"id":"gt-7ao","title":"Test manual create","description":"Testing manual create","status":"open","priority":2,"issue_type":"message","assignee":"mayor/","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T16:45:57Z","created_by":"gastown/polecats/furiosa","updated_at":"2026-01-19T16:45:57Z"}
{"id":"gt-7lz","title":"Confirm GT_ROLE env var bug in polecat startup hooks","description":"## Issue\n\nPolecat startup hooks fail with 'role mismatch' because `bash -l -c` (login shell) doesn't inherit tmux environment variables.\n\n## Root Cause Hypothesis\n\n1. `gt sling` sets `GT_ROLE=polecat` in tmux environment via `tmux set-environment`\n2. Claude Code runs hooks via `bash -l -c '\u003ccommand\u003e'` (login shell)\n3. Login shell reads ~/.bashrc which may set `GT_ROLE=mayor` (from parent session)\n4. Hook sees wrong `GT_ROLE`, `gt prime` detects mismatch, errors\n\n## Confirmation Steps\n\n1. Verify tmux env has correct `GT_ROLE`:\n   ```bash\n   tmux show-environment -t gt-fhc-ermine | grep GT_ROLE\n   # Expected: GT_ROLE=polecat\n   ```\n\n2. Verify login shell overrides it:\n   ```bash\n   bash -l -c 'echo $GT_ROLE'\n   # Actual: mayor (from ~/.bashrc)\n   ```\n\n3. Verify this causes the hook error:\n   ```bash\n   bash -l -c 'gt prime 2\u003e\u00261' | head -5\n   # Shows: ROLE/LOCATION MISMATCH\n   ```\n\n## Deliverable\n\n1. Confirm the hypothesis with evidence\n2. Write a failing test that reproduces the issue\n3. Document findings in bead comments","status":"open","priority":1,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-17T05:42:39Z","created_by":"mayor","updated_at":"2026-01-17T05:42:39Z"}
{"id":"gt-7r0","title":"Route test final","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T08:51:25Z","created_by":"gastown/crew/gastown9_dolt","updated_at":"2026-01-19T08:51:25Z"}
{"id":"gt-7ybk","title":"Add Dolt lock retry and timeout tests","description":"**Goal**: Add tests for Dolt lock handling behavior that we identified as missing during bug investigation.\n\n**Background**: \nInvestigation of rig-2b9509 (database read-only error) revealed that Dolt's file-based locking can cause contention. We need tests to verify proper handling of lock timeouts and retry logic.\n\n**Tests to Add**:\n\n1. **TestDoltLockTimeout** - Verify --lock-timeout flag behavior\n   - One process holds lock for extended period\n   - Second process attempts to acquire lock\n   - Verify timeout is respected\n   - Verify appropriate error message\n\n2. **TestDoltLockRetryWithBackoff** - Test retry logic (when implemented)\n   - First process holds lock briefly\n   - Second process retries with backoff\n   - Verify successful acquisition after retry\n   - Verify exponential backoff timing\n\n3. **TestDoltReadOnlyFallback** - Test read-only mode fallback\n   - Write lock unavailable\n   - Verify graceful fallback to read-only\n   - Verify read operations succeed\n   - Verify write operations fail with clear error\n\n4. **TestDoltMultipleProcessContention** - Simulate real-world scenario\n   - Multiple bd processes compete for lock (like witness patrol + mail operations)\n   - Verify all processes eventually succeed or timeout gracefully\n   - No silent failures or corruption\n\n5. **TestDoltConnectionPooling** - Test connection lifecycle\n   - Verify connections close properly after operations\n   - Verify lock is released when connection closes\n   - Test with SetConnMaxLifetime(0) current behavior\n\n**Files to Modify**:\n- `internal/storage/dolt/concurrent_test.go` - Add new test cases\n- `internal/storage/dolt/store.go` - May need instrumentation for testing\n\n**Acceptance**:\n- All 5 tests pass\n- Tests run in CI\n- Coverage report shows lock handling paths tested\n\n**References**:\n- rig-2b9509: Database read-only error investigation\n- docs/formula-resolution.md: Similar concurrent access patterns","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T20:47:08Z","created_by":"mayor","updated_at":"2026-01-19T20:47:08Z"}
{"id":"gt-817","title":"Test default routing","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T08:49:44Z","created_by":"gastown/crew/gastown9_dolt","updated_at":"2026-01-19T08:49:44Z"}
{"id":"gt-8ba","title":"gt polecat remove checks commits against main instead of feature branch","description":"## Problem\n\ngt polecat remove --force incorrectly reports 'has uncommitted work: 1 unpushed commit(s)' when:\n1. The feature branch IS pushed to origin\n2. git log origin/\u003cbranch\u003e...HEAD shows no unpushed commits\n3. git status --porcelain is clean\n\n## Root Cause\n\nThe tool checks commits against origin/main instead of the polecat's tracking branch.\n\n## Fix Needed\n\ngt polecat remove should compare HEAD against the current tracking branch, not main.\n\nFiled by: gastown/witness","status":"open","priority":2,"issue_type":"bug","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-17T22:22:32Z","created_by":"mayor","updated_at":"2026-01-17T22:22:32Z"}
{"id":"gt-ap0","title":"No ref test","status":"open","priority":1,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T07:30:55Z","created_by":"beads/polecats/quartz","updated_at":"2026-01-19T07:30:55Z"}
{"id":"gt-ap2","title":"Test hooked bead","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-17T04:43:30Z","created_by":"gastown/polecats/furiosa","updated_at":"2026-01-17T04:43:30Z"}
{"id":"gt-bpm","title":"No ref test","status":"open","priority":1,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T00:47:29Z","created_by":"beads/crew/dolt_fixer","updated_at":"2026-01-19T00:47:29Z"}
{"id":"gt-c0cp","title":"Test hq prefix after cleanup","description":"Verifying hq- prefix works","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T17:16:44Z","created_by":"gastown/crew/gastown9_dolt","updated_at":"2026-01-19T17:16:44Z"}
{"id":"gt-c6l","title":"Test 3 - hq issue-prefix","description":"Third test with issue-prefix set to hq.","status":"open","priority":1,"issue_type":"message","assignee":"mayor/","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T16:45:43Z","created_by":"gastown/polecats/furiosa","updated_at":"2026-01-19T16:45:43Z","labels":["from:gastown/polecats/furiosa","thread:thread-2da393bdae05"]}
{"id":"gt-dj4","title":"Explicit Dolt","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T08:47:07Z","created_by":"gastown/crew/gastown9_dolt","updated_at":"2026-01-19T08:47:07Z"}
{"id":"gt-e8p","title":"Pure Dolt test","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T08:42:12Z","created_by":"admin","updated_at":"2026-01-19T08:42:12Z"}
{"id":"gt-f2dp","title":"Approval needed: Clean town beads for hq- prefix migration","description":"Working on rig-297d2b (gt- prefix routing conflict).\n\nFound root cause: Beads enforces prefix consistency. Town beads has gt- prefixed test messages, so it refuses to create new hq- messages.\n\nRequesting approval for Option A (Fresh Start):\n- Delete all test gt- messages from town beads (~/gt/.beads/)\n- These are all test messages created during debugging\n- Once clean, beads will auto-use hq- prefix per config\n- Establishes correct architecture: town=hq-, rig=gt-\n\nAlternative is complex migration script to rename IDs and update all references.\n\nPlease approve or suggest alternative approach.\n\nDetails in bug comments: rig-297d2b","status":"open","priority":1,"issue_type":"message","assignee":"mayor/","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T17:01:53Z","created_by":"gastown/polecats/furiosa","updated_at":"2026-01-19T17:01:53Z","labels":["from:gastown/polecats/furiosa","thread:thread-ab4b4a0d7271"]}
{"id":"gt-ftpm","title":"Dolt workflow test","description":"Testing Dolt-native workflow","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T17:36:56Z","created_by":"gastown/crew/gastown9_dolt","updated_at":"2026-01-19T17:36:56Z"}
{"id":"gt-gastown-crew-code_review","title":"Crew worker code_review in gastown - human-managed persistent workspace.","description":"Crew worker code_review in gastown - human-managed persistent workspace.\n\nrole_type: crew\nrig: gastown\nagent_state: idle\nhook_bead: null\nrole_bead: hq-crew-role\ncleanup_status: null\nactive_mr: null\nnotification_level: null\nowned_formulas: null","status":"open","priority":2,"issue_type":"agent","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-18T18:37:39Z","created_by":"gastown/crew/validator","updated_at":"2026-01-18T18:37:39Z","labels":["gt:agent"]}
{"id":"gt-gastown-crew-commit_auditor","title":"Crew worker commit_auditor in gastown - human-managed persistent workspace.","description":"Crew worker commit_auditor in gastown - human-managed persistent workspace.\n\nrole_type: crew\nrig: gastown\nagent_state: idle\nhook_bead: null\nrole_bead: hq-crew-role\ncleanup_status: null\nactive_mr: null\nnotification_level: null\nowned_formulas: null","status":"open","priority":2,"issue_type":"agent","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-18T18:37:40Z","created_by":"gastown/crew/validator","updated_at":"2026-01-18T18:37:40Z","labels":["gt:agent"]}
{"id":"gt-gastown-crew-upstream_sync","title":"Crew worker upstream_sync in gastown - human-managed persistent workspace.","description":"Crew worker upstream_sync in gastown - human-managed persistent workspace.\n\nrole_type: crew\nrig: gastown\nagent_state: idle\nhook_bead: null\nrole_bead: hq-crew-role\ncleanup_status: null\nactive_mr: null\nnotification_level: null\nowned_formulas: null","status":"open","priority":2,"issue_type":"agent","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-18T18:37:41Z","created_by":"gastown/crew/validator","updated_at":"2026-01-18T18:37:41Z","labels":["gt:agent"]}
{"id":"gt-gastown-crew-validator","title":"Crew worker validator","status":"open","priority":2,"issue_type":"agent","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-18T18:36:16Z","created_by":"gastown/crew/validator","updated_at":"2026-01-18T18:36:16Z"}
{"id":"gt-gastown-polecat-capable","title":"gt-gastown-polecat-capable","description":"gt-gastown-polecat-capable\n\nrole_type: polecat\nrig: gastown\nagent_state: spawning\nhook_bead: hq-0rbvjw.3\nrole_bead: hq-polecat-role\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-17T18:03:27Z","created_by":"mayor","updated_at":"2026-01-17T18:03:27Z","labels":["gt:agent"]}
{"id":"gt-gastown-polecat-dementus","title":"gt-gastown-polecat-dementus","description":"gt-gastown-polecat-dementus\n\nrole_type: polecat\nrig: gastown\nagent_state: spawning\nhook_bead: hq-0rbvjw.2\nrole_bead: hq-polecat-role\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-17T18:02:24Z","created_by":"mayor","updated_at":"2026-01-17T18:02:24Z","labels":["gt:agent"]}
{"id":"gt-gastown-polecat-furiosa","title":"gt-gastown-polecat-furiosa","description":"gt-gastown-polecat-furiosa\n\nrole_type: polecat\nrig: gastown\nagent_state: spawning\nhook_bead: gt-27eer\nrole_bead: hq-polecat-role\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-17T04:38:48Z","created_by":"mayor","updated_at":"2026-01-17T04:38:48Z","labels":["gt:agent"]}
{"id":"gt-gastown-polecat-nux","title":"gt-gastown-polecat-nux","description":"gt-gastown-polecat-nux\n\nrole_type: polecat\nrig: gastown\nagent_state: spawning\nhook_bead: gt-q7y\nrole_bead: hq-polecat-role\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-17T04:40:20Z","created_by":"mayor","updated_at":"2026-01-17T04:40:20Z","labels":["gt:agent"]}
{"id":"gt-gastown-polecat-rictus","title":"gt-gastown-polecat-rictus","description":"gt-gastown-polecat-rictus\n\nrole_type: polecat\nrig: gastown\nagent_state: spawning\nhook_bead: hq-0rbvjw.1\nrole_bead: hq-polecat-role\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-17T18:00:29Z","created_by":"mayor","updated_at":"2026-01-17T18:00:29Z","labels":["gt:agent"]}
{"id":"gt-gastown-polecat-slit","title":"gt-gastown-polecat-slit","description":"gt-gastown-polecat-slit\n\nrole_type: polecat\nrig: gastown\nagent_state: spawning\nhook_bead: gt-oq2w6\nrole_bead: hq-polecat-role\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-17T04:42:13Z","created_by":"mayor","updated_at":"2026-01-17T04:42:13Z","labels":["gt:agent"]}
{"id":"gt-gastown-polecat-toast","title":"gt-gastown-polecat-toast","description":"gt-gastown-polecat-toast\n\nrole_type: polecat\nrig: gastown\nagent_state: spawning\nhook_bead: hq-0rbvjw.4\nrole_bead: hq-polecat-role\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-17T18:04:23Z","created_by":"mayor","updated_at":"2026-01-17T18:04:23Z","labels":["gt:agent"]}
{"id":"gt-gastown-refinery","title":"Refinery for gastown - processes merge queue.","description":"Refinery for gastown - processes merge queue.\n\nrole_type: refinery\nrig: gastown\nagent_state: idle\nhook_bead: null\nrole_bead: hq-refinery-role\ncleanup_status: null\nactive_mr: null\nnotification_level: null\nowned_formulas: null","status":"open","priority":2,"issue_type":"agent","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T08:52:10Z","created_by":"gastown/crew/gastown9_dolt","updated_at":"2026-01-19T08:52:10Z","labels":["gt:agent"]}
{"id":"gt-gastown-witness","title":"Witness for gastown - monitors polecat health and progress.","description":"Witness for gastown - monitors polecat health and progress.\n\nrole_type: witness\nrig: gastown\nagent_state: idle\nhook_bead: null\nrole_bead: hq-witness-role\ncleanup_status: null\nactive_mr: null\nnotification_level: null\nowned_formulas: null","status":"open","priority":2,"issue_type":"agent","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T08:52:10Z","created_by":"gastown/crew/gastown9_dolt","updated_at":"2026-01-19T08:52:10Z","labels":["gt:agent"]}
{"id":"gt-gza","title":"Create rig structures in gastown9","description":"## Goal\nSet up proper rig directory structures for all migrated prefixes in gastown9.\n\n## COMPLETED ✓\n\n### Rigs Created\n| Rig | Prefix | Git URL | Status |\n|-----|--------|---------|--------|\n| beads | bd- | github.com/groblegark/beads.git | ✓ |\n| local | loc- | gitlab.com/PiHealth/CoreFICS/local.git | ✓ |\n| helm | he- | gitlab.com/PiHealth/CoreFICS/local.git | ✓ |\n| fhc | fhc- | gitlab.com/PiHealth/CoreFICS/local.git | ✓ |\n| sd | sd- | gitlab.com/PiHealth/CoreFICS/site-deployment.git | ✓ |\n| spa | spa- | gitlab.com/PiHealth/CoreFICS/sponsor-api.git | ✓ |\n| sw | sw- | gitlab.com/PiHealth/CoreFICS/study-web.git | ✓ |\n| cicd | ci- | gitlab.com/PiHealth/PiHealthEngineering/cicd-templates.git | ✓ |\n\n### Structure\nEach rig has:\n- config.json with rig metadata and beads prefix\n- mayor/rig/ with cloned code repository\n- .beads symlinked to central gastown/mayor/rig/.beads\n\n### Central Database\nAll rigs share the Dolt database at gastown/mayor/rig/.beads/dolt/beads/\n\n### Usage\nFrom any rig directory, run bd list --no-daemon to access all issues.\nUse --all --limit N to see closed issues.\n","status":"open","priority":2,"issue_type":"epic","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T10:51:28Z","created_by":"gastown/crew/gastown9_dolt","updated_at":"2026-01-19T10:51:28Z"}
{"id":"gt-ibi","title":"Research cicd-templates components and document troubleshooting patterns","description":"Initial research task for pipeline_troubleshooter crew.\n\n## Goals\n\n1. **Explore the repository structure** - Understand what templates exist and how they're organized\n\n2. **Document each component** - For each major component (build-multi, terraform, helm, e2e, migrations, release):\n   - What does it do?\n   - What are common failure modes?\n   - What are the key variables/configuration points?\n\n3. **Identify troubleshooting patterns** - What steps work to diagnose issues?\n\n4. **Update the formula** - Improve mol-pipeline-troubleshoot based on findings\n\n5. **Update CLAUDE.md** - Add repository-specific knowledge\n\n## Deliverables\n\n- Summary of each component's purpose\n- List of common issues per component\n- Proposed improvements to the formula\n- Updated CLAUDE.md with troubleshooting knowledge\n\nReport findings to Mayor for discussion.","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-18T18:13:31Z","created_by":"mayor","updated_at":"2026-01-18T18:13:31Z"}
{"id":"gt-iry","title":"Fix GT_ROLE env inheritance in startup hooks","description":"## Context\n\nDepends on gt-7lz confirming the issue.\n\n## Proposed Fix\n\nOption 1 (preferred): Hook should explicitly source tmux env before running\n\nModify the global hook in ~/.claude/settings.json to source tmux environment:\n\n```json\n{\n  \"SessionStart\": [{\n    \"hooks\": [{\n      \"command\": \"eval \\$(tmux show-environment -s 2\u003e/dev/null) \u0026\u0026 export PATH=\\\"\\$HOME/go/bin:\\$HOME/bin:\\$PATH\\\" \u0026\u0026 gt prime \u0026\u0026 gt nudge deacon session-started\"\n    }]\n  }]\n}\n```\n\nThe `tmux show-environment -s` outputs shell-compatible export statements.\n\n## Deliverable\n\n1. Make the failing test pass\n2. Update ~/.claude/settings.json with fixed hook\n3. Verify polecats start without hook errors","status":"open","priority":1,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-17T05:42:52Z","created_by":"mayor","updated_at":"2026-01-17T05:42:52Z"}
{"id":"gt-iv4","title":"Test issue for Dolt backend","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T08:37:56Z","created_by":"gastown/crew/gastown9_dolt","updated_at":"2026-01-19T08:37:56Z"}
{"id":"gt-jef","title":"Test issue 2","status":"open","priority":2,"issue_type":"bug","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T00:12:06Z","created_by":"beads/refinery","updated_at":"2026-01-19T00:12:06Z"}
{"id":"gt-jvv","title":"Dolt test 1","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T00:13:53Z","created_by":"beads/refinery","updated_at":"2026-01-19T00:13:53Z"}
{"id":"gt-knpo","title":"Add Dolt lock retry and timeout tests","description":"Add missing test coverage for lock handling","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T20:47:17Z","created_by":"mayor","updated_at":"2026-01-19T20:47:17Z"}
{"id":"gt-local-polecat-fisher","title":"gt-local-polecat-fisher","status":"open","priority":2,"issue_type":"agent","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-18T19:45:27Z","created_by":"local/crew/e2e_fix_1test","updated_at":"2026-01-18T19:45:27Z"}
{"id":"gt-local-test","title":"test","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-18T19:46:09Z","created_by":"local/crew/e2e_fix_1test","updated_at":"2026-01-18T19:46:09Z"}
{"id":"gt-local-test2","title":"test2","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-18T19:46:30Z","created_by":"local/crew/e2e_fix_1test","updated_at":"2026-01-18T19:46:30Z"}
{"id":"gt-m00","title":"Direct test","description":"Direct create test","status":"open","priority":2,"issue_type":"message","assignee":"mayor/","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T16:55:54Z","created_by":"gastown/polecats/furiosa","updated_at":"2026-01-19T16:55:54Z"}
{"id":"gt-m2o","title":"Create rig structures in gastown9","description":"## Goal\nSet up proper rig directory structures for all migrated prefixes in gastown9.\n\n## Current State\n- All data migrated to gastown/mayor/rig (Dolt backend)\n- Routes configured for: bd-, hq-, gt-, loc-, he-, fhc-, sd-, spa-, sw-, ci-\n- All routes point to single gastown/mayor/rig location\n\n## Rigs to Create\n1. **beads/** - bd- prefix (beads CLI development)\n2. **local/** - loc- prefix (local dev environment)\n3. **helm/** - he- prefix (Kubernetes/Helm)\n4. **fhc/** - fhc- prefix \n5. **sd/** - sd- prefix\n6. **spa/** - spa- prefix\n7. **sw/** - sw- prefix\n8. **cicd/** - ci- prefix\n9. **hq/** or root - hq- prefix (coordination)\n\n## Structure per Rig\nEach rig needs:\n- config.json\n- mayor/rig/ with .beads routing\n- Optional: crew/, refinery/, witness/, polecats/\n\n## Routing Decision\n- Option A: Each rig has own .beads pointing to central Dolt\n- Option B: Keep all routes in root gastown9/.beads/routes.jsonl","status":"open","priority":2,"issue_type":"epic","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T10:43:01Z","created_by":"gastown/crew/gastown9_dolt","updated_at":"2026-01-19T10:43:01Z"}
{"id":"gt-m3n7","title":"Routing test 3","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T17:37:56Z","created_by":"gastown/crew/gastown9_dolt","updated_at":"2026-01-19T17:37:56Z"}
{"id":"gt-myc","title":"Fix inconsistent agent bead prefix strategies between manager.go and sling_helpers.go","description":"## Problem\n\nAgent bead creation uses TWO inconsistent approaches, resulting in duplicate agent beads with different prefixes:\n\n- `sling_helpers.go`: Uses rig prefix (e.g., `gt-gastown-polecat-furiosa`)\n- `manager.go`: Uses town prefix (e.g., `hq-gastown-polecat-furiosa`)\n\nThis causes operational issues where:\n1. Hook commands look for one prefix\n2. Lifecycle management looks for a different prefix\n3. Agent beads are duplicated across databases\n\n## Evidence\n\n```bash\nbd list --type=agent | grep furiosa\n○ gt-gastown-polecat-furiosa [● P2] [agent]  # Created by hook system\n○ hq-gastown-polecat-furiosa [● P2] [agent]  # Created by lifecycle system\n```\n\n## Root Cause\n\nTwo commits resolved the original prefix issue differently:\n- f869fea3: \"Store agent beads in town beads with hq- prefix\" (manager.go)\n- 56c986e7: \"Use rig prefix instead of hardcoded hq-\" (sling_helpers.go)\n\nThese need to be aligned on ONE strategy.\n\n## Solution Options\n\n### Option A: Rig-prefix beads (RECOMMENDED)\n- Update `manager.go:114-116` to use `PolecatBeadIDWithPrefix(prefix, rig, name)`\n- Beads stored in rig `.beads/` directory\n- Uses rig's configured prefix (gt-, fhc-, spa-, etc.)\n- Aligns with existing beads infrastructure\n\n### Option B: Town-prefix beads\n- Update `sling_helpers.go:345-361` to use `PolecatBeadIDTown(rig, name)`\n- All agent beads stored in town `~/gt/.beads/`\n- Uses \"hq-\" prefix consistently\n- Avoids cross-database routing issues\n\n## Implementation Steps\n\n1. Choose strategy (Option A recommended)\n2. Update the inconsistent code path\n3. Test scenarios:\n   - Spawn new polecat → verify agent bead ID\n   - Hook work to polecat → verify hook finds agent bead\n   - Polecat lifecycle events → verify manager finds agent bead\n   - Short rig names (fhc, spa, sd, sw) → verify no duplication\n4. Clean up duplicate agent beads (script or manual)\n5. Document the chosen strategy in code comments\n\n## Files to Modify\n\nIf Option A (rig-prefix):\n- `internal/polecat/manager.go:114-116`\n\nIf Option B (town-prefix):\n- `internal/cmd/sling_helpers.go:345-361`\n\n## Testing Checklist\n\n- [ ] Spawn new polecat, verify agent bead ID matches hook system expectations\n- [ ] Hook work to polecat, verify no \"bead not found\" errors\n- [ ] Trigger lifecycle events (status updates), verify agent bead updates correctly\n- [ ] Test with short rig name (fhc, spa, sd, sw) to verify deduplication still works\n- [ ] Verify no duplicate agent beads created\n\n## Related\n\nParent: gt-lv426 (Agent bead prefix issues: investigation findings and options)\n","status":"open","priority":2,"issue_type":"bug","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T16:38:46Z","created_by":"gastown/witness","updated_at":"2026-01-19T16:38:46Z"}
{"id":"gt-n6oq","title":"Debug mail","description":"Debug test","status":"open","priority":1,"issue_type":"message","assignee":"mayor/","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T17:08:05Z","created_by":"gastown/crew/gastown9_dolt","updated_at":"2026-01-19T17:08:05Z","labels":["from:gastown/crew/gastown9_dolt","thread:thread-cc8aa73a45ea"]}
{"id":"gt-nxf","title":"Upgrade gastown and beads from groblegark fork","description":"Pull latest changes from the groblegark fork of gastown and beads submodules.\n\n## Tasks\n1. Fetch from fork remote (groblegark) for both submodules\n2. Merge/rebase to latest fork/main\n3. Rebuild gt and bd tools after update\n4. Run gt doctor and bd doctor to verify health\n5. Report any issues or conflicts\n\n## Repos\n- gastown: fork remote -\u003e https://github.com/groblegark/gastown.git\n- beads: fork remote -\u003e https://github.com/groblegark/beads.git\n\n## Commands\n```bash\ncd /home/ubuntu/pihealth/submodules/gastown\ngit fetch fork\ngit merge fork/main --ff-only || git rebase fork/main\n\ncd /home/ubuntu/pihealth/submodules/beads  \ngit fetch fork\ngit merge fork/main --ff-only || git rebase fork/main\n\n# Rebuild tools\ncd /home/ubuntu/pihealth/submodules/gastown \u0026\u0026 go build -o ~/go/bin/gt ./cmd/gt\ngo build -o ~/go/bin/bd ./cmd/bd\n\n# Verify\ngt doctor\nbd doctor\n```","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-18T20:00:36Z","created_by":"mayor","updated_at":"2026-01-18T20:00:36Z"}
{"id":"gt-oyt","title":"No import test","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T08:51:36Z","created_by":"gastown/crew/gastown9_dolt","updated_at":"2026-01-19T08:51:36Z"}
{"id":"gt-pdm","title":"Clean env test","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T08:50:15Z","created_by":"Refinery","updated_at":"2026-01-19T08:50:15Z"}
{"id":"gt-qub","title":"Fix inconsistent agent bead prefix strategies in manager.go and sling_helpers.go","description":"## Problem\n\nAgent bead creation uses TWO inconsistent approaches, resulting in duplicate agent beads with different prefixes:\n\n- `sling_helpers.go`: Uses rig prefix (e.g., `gt-gastown-polecat-furiosa`)\n- `manager.go`: Uses town prefix (e.g., `hq-gastown-polecat-furiosa`)\n\nThis causes operational issues where:\n1. Hook commands look for one prefix\n2. Lifecycle management looks for a different prefix\n3. Agent beads are duplicated across databases\n\n## Evidence\n\n```bash\nbd list --type=agent | grep furiosa\n○ gt-gastown-polecat-furiosa [● P2] [agent]  # Created by hook system\n○ hq-gastown-polecat-furiosa [● P2] [agent]  # Created by lifecycle system\n```\n\n## Root Cause\n\nTwo commits resolved the original prefix issue differently:\n- f869fea3: \"Store agent beads in town beads with hq- prefix\" (manager.go)\n- 56c986e7: \"Use rig prefix instead of hardcoded hq-\" (sling_helpers.go)\n\nThese need to be aligned on ONE strategy.\n\n## Solution Options\n\n### Option A: Rig-prefix beads (RECOMMENDED)\n- Update `manager.go:114-116` to use `PolecatBeadIDWithPrefix(prefix, rig, name)`\n- Beads stored in rig `.beads/` directory\n- Uses rig's configured prefix (gt-, fhc-, spa-, etc.)\n- Aligns with existing beads infrastructure\n\n### Option B: Town-prefix beads\n- Update `sling_helpers.go:345-361` to use `PolecatBeadIDTown(rig, name)`\n- All agent beads stored in town `~/gt/.beads/`\n- Uses \"hq-\" prefix consistently\n- Avoids cross-database routing issues\n\n## Implementation Steps\n\n1. Choose strategy (Option A recommended)\n2. Update the inconsistent code path\n3. Test scenarios:\n   - Spawn new polecat → verify agent bead ID\n   - Hook work to polecat → verify hook finds agent bead\n   - Polecat lifecycle events → verify manager finds agent bead\n   - Short rig names (fhc, spa, sd, sw) → verify no duplication\n4. Clean up duplicate agent beads (script or manual)\n5. Document the chosen strategy in code comments\n\n## Files to Modify\n\nIf Option A (rig-prefix):\n- `internal/polecat/manager.go:114-116`\n\nIf Option B (town-prefix):\n- `internal/cmd/sling_helpers.go:345-361`\n\n## Testing Checklist\n\n- [ ] Spawn new polecat, verify agent bead ID matches hook system expectations\n- [ ] Hook work to polecat, verify no \"bead not found\" errors\n- [ ] Trigger lifecycle events (status updates), verify agent bead updates correctly\n- [ ] Test with short rig name (fhc, spa, sd, sw) to verify deduplication still works\n- [ ] Verify no duplicate agent beads created\n\n## Related\n\nParent: gt-lv426 (Agent bead prefix issues: investigation findings and options)\n","status":"open","priority":2,"issue_type":"bug","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T16:38:27Z","created_by":"gastown/witness","updated_at":"2026-01-19T16:38:27Z"}
{"id":"gt-r1h","title":"Create rig structures in gastown9 - COMPLETED","status":"open","priority":2,"issue_type":"epic","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T10:52:48Z","created_by":"gastown/crew/gastown9_dolt","updated_at":"2026-01-19T10:52:48Z"}
{"id":"gt-rig-polecat-TestAgent","title":"gt-rig-polecat-TestAgent","description":"gt-rig-polecat-TestAgent\n\nrole_type: polecat\nrig: rig\nagent_state: spawning\nhook_bead: null\nrole_bead: hq-polecat-role\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-17T04:43:12Z","created_by":"gastown/polecats/furiosa","updated_at":"2026-01-17T04:43:12Z","labels":["gt:agent"]}
{"id":"gt-rig-polecat-TestFallback","title":"gt-rig-polecat-TestFallback","description":"gt-rig-polecat-TestFallback\n\nrole_type: polecat\nrig: rig\nagent_state: spawning\nhook_bead: null\nrole_bead: hq-polecat-role\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-17T04:43:13Z","created_by":"gastown/polecats/furiosa","updated_at":"2026-01-17T04:43:13Z","labels":["gt:agent"]}
{"id":"gt-s40","title":"No autoimport test","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T08:47:53Z","created_by":"gastown/crew/gastown9_dolt","updated_at":"2026-01-19T08:47:53Z"}
{"id":"gt-sb8","title":"Test 2 - hq prefix","description":"Second test to verify hq- prefix is working.","status":"open","priority":1,"issue_type":"message","assignee":"mayor/","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T16:44:50Z","created_by":"gastown/polecats/furiosa","updated_at":"2026-01-19T16:44:50Z","labels":["from:gastown/polecats/furiosa","thread:thread-2376c177d4f3"]}
{"id":"gt-suj","title":"gt polecat remove checks commits against main instead of feature branch","description":"## Problem\n\n`gt polecat remove --force` incorrectly reports 'has uncommitted work: 1 unpushed commit(s)' when:\n1. The feature branch IS pushed to origin\n2. `git log origin/\u003cbranch\u003e...HEAD` shows no unpushed commits\n3. `git status --porcelain` is clean\n\n## Root Cause\n\nThe tool checks commits against `origin/main` instead of the polecat's tracking branch.\n\n## Evidence\n\nBranch: `polecat/rictus/hq-0rbvjw.6@mkiv7qq9`\n- EXISTS on origin (verified)\n- git log origin/\u003cbranch\u003e...HEAD = empty\n- git status = clean\n- Yet gt polecat remove reports unpushed commits\n\n## Fix Needed\n\n`gt polecat remove` should compare HEAD against the current tracking branch, not main.\n\n## Workaround\n\nManual verification + rm -rf.\n\nFiled by: gastown/witness","status":"open","priority":2,"issue_type":"bug","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-17T22:21:47Z","created_by":"mayor","updated_at":"2026-01-17T22:21:47Z"}
{"id":"gt-sxp","title":"Final test - hq prefix","description":"Final test after updating Dolt config.","status":"open","priority":1,"issue_type":"message","assignee":"mayor/","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T16:47:35Z","created_by":"gastown/polecats/furiosa","updated_at":"2026-01-19T16:47:35Z","labels":["from:gastown/polecats/furiosa","thread:thread-7a4510606645"]}
{"id":"gt-tb6","title":"Replace FIFO-based decision receiver with HTTP server","description":"The current decision-point receiver uses FIFOs (named pipes) for IPC, which causes problems with Claude Code - likely blocking/buffering issues that destabilize sessions.\n\n## Problem\n- FIFOs block on read/write if no process on other end\n- Claude Code sessions can hang or crash when interacting with FIFOs\n- Named pipes have platform-specific quirks (especially macOS vs Linux)\n\n## Proposed Solution\nReplace FIFO-based IPC with a simple HTTP server:\n\n1. **Start HTTP server** on localhost with random high port\n2. **Write port to file** for Claude to discover\n3. **POST /decision** endpoint receives decision requests as JSON\n4. **Response** returns user's accept/reject choice\n5. **Timeout handling** via HTTP timeouts (cleaner than FIFO timeouts)\n\n## Benefits\n- No blocking issues - HTTP is request/response\n- Better error handling and timeouts\n- Easier debugging (can curl the endpoint)\n- Cross-platform consistency\n- Can add health check endpoint\n\n## Implementation Notes\n- Use Go's net/http (simple, no deps)\n- Port discovery via file or env var\n- JSON request/response for structure\n- Graceful shutdown on session end\n\n## Related\n- Parent epic: hq-0rbvjw (Decision-point agent UX)\n- Replaces: decision-receiver.sh FIFO approach","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-18T17:35:07Z","created_by":"mayor","updated_at":"2026-01-18T17:35:07Z"}
{"id":"gt-te9v","title":"Test hq again","description":"Testing","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T17:04:49Z","created_by":"gastown/crew/gastown9_dolt","updated_at":"2026-01-19T17:04:49Z"}
{"id":"gt-test-routing","title":"Test routing","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-18T18:49:14Z","created_by":"gastown/crew/validator","updated_at":"2026-01-18T18:49:14Z"}
{"id":"gt-thzq","title":"Test default create","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T17:08:25Z","created_by":"gastown/crew/gastown9_dolt","updated_at":"2026-01-19T17:08:25Z"}
{"id":"gt-tlw","title":"Test with explicit db","description":"Testing","status":"open","priority":2,"issue_type":"message","assignee":"mayor/","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T16:57:29Z","created_by":"gastown/polecats/furiosa","updated_at":"2026-01-19T16:57:29Z"}
{"id":"gt-u73","title":"Test fix for rig-4ceabf","description":"Testing that mail messages now persist correctly to Dolt with hq- prefix and correct routing.","status":"open","priority":1,"issue_type":"message","assignee":"mayor/","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T16:44:16Z","created_by":"gastown/polecats/furiosa","updated_at":"2026-01-19T16:44:16Z","labels":["from:gastown/polecats/furiosa","thread:thread-8b4c39fbd1ce"]}
{"id":"gt-uq9","title":"Test hq prefix routing","description":"Testing that new messages get hq- prefix","status":"open","priority":1,"issue_type":"message","assignee":"mayor/","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T16:55:37Z","created_by":"gastown/polecats/furiosa","updated_at":"2026-01-19T16:55:37Z","labels":["from:gastown/polecats/furiosa","thread:thread-e48583990e01"]}
{"id":"gt-w39i","title":"Test hq prefix","description":"Testing that new issues get hq- prefix","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T17:04:42Z","created_by":"gastown/crew/gastown9_dolt","updated_at":"2026-01-19T17:04:42Z"}
{"id":"gt-xos","title":"Pre-existing test failures in cmd/bd: routing, show, sync tests","status":"open","priority":2,"issue_type":"bug","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-17T07:14:08Z","created_by":"beads/refinery","updated_at":"2026-01-17T07:14:08Z"}
{"id":"gt-xuk","title":"MR Request: Dolt backend test file","description":"Please process this MR to add DOLT_TEST.md file.\n\nBranch: gastown9\nCommit: 1c488cd\nChange: Added DOLT_TEST.md for Dolt workflow validation\n\nThis is a test of the end-to-end MR workflow with Dolt backend (gt-a0d64a).","status":"open","priority":1,"issue_type":"message","assignee":"mayor/","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T16:31:30Z","created_by":"gastown/crew/gastown9_dolt","updated_at":"2026-01-19T16:31:30Z","labels":["from:gastown/crew/gastown9_dolt","thread:thread-483bc11b6ede"]}
{"id":"gt-y6q","title":"Debug test","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T08:43:53Z","created_by":"admin","updated_at":"2026-01-19T08:43:53Z"}
{"id":"gt-yft","title":"Test routing debug","description":"Debug test","status":"open","priority":2,"issue_type":"message","assignee":"mayor/","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T16:57:14Z","created_by":"gastown/polecats/furiosa","updated_at":"2026-01-19T16:57:14Z"}
{"id":"gt-z2kv","title":"Test with yaml config","description":"Testing yaml prefix","status":"open","priority":2,"issue_type":"message","assignee":"mayor/","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T16:58:00Z","created_by":"gastown/polecats/furiosa","updated_at":"2026-01-19T16:58:00Z"}
{"id":"gt-zjy","title":"Test Dolt issue","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T08:38:41Z","created_by":"gastown/crew/gastown9_dolt","updated_at":"2026-01-19T08:38:41Z"}
{"id":"gt-zky","title":"Verbose test","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T08:44:36Z","created_by":"admin","updated_at":"2026-01-19T08:44:36Z"}
{"id":"hq-test-polecat-manual3","title":"test","description":"test","status":"open","priority":2,"issue_type":"agent","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-19T22:44:54Z","created_by":"mayor","updated_at":"2026-01-19T22:44:54Z","labels":["gt:agent"]}
