{"id":"bd-0yl","title":"Fix TestValidateAgentID failing tests for witness_alone and refinery_alone","description":"The TestValidateAgentID tests expect 'gt-witness' and 'gt-refinery' to be invalid agent IDs, but ValidateAgentID currently accepts them as valid.\n\nFailing tests:\n- TestValidateAgentID/witness_alone: ValidateAgentID(\"gt-witness\") error = \u003cnil\u003e, wantError true\n- TestValidateAgentID/refinery_alone: ValidateAgentID(\"gt-refinery\") error = \u003cnil\u003e, wantError true\n\nEither:\n1. The validation logic needs to be fixed to reject these IDs\n2. Or the test expectations need to be updated if these IDs are actually valid\n\nThis was discovered while fixing bd-3q6.9/bd-3q6.10 (invalid issue type merge-request).","status":"open","priority":3,"issue_type":"bug","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T04:10:52.581038553Z","created_by":"mayor","updated_at":"2026-01-20T04:10:52.581038553Z"}
{"id":"bd-3q6","title":"Sling Pipeline E2E Test Deviances","description":"Tracking deviances found during E2E test of: sling -\u003e polecat -\u003e refinery -\u003e groblegark main -\u003e installation","status":"open","priority":2,"issue_type":"epic","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T03:46:06.118674191Z","created_by":"mayor","updated_at":"2026-01-20T03:46:06.118674191Z"}
{"id":"bd-3q6.1","title":"Refinery startup times out waiting for runtime prompt","description":"gt refinery start beads consistently times out with: 'timeout waiting for runtime prompt'. Prevents automated MR processing.","status":"closed","priority":2,"issue_type":"bug","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T03:46:15.036926385Z","created_by":"mayor","updated_at":"2026-01-20T03:51:37.359534552Z","closed_at":"2026-01-20T03:51:37.359534552Z","close_reason":"Fixed: changed ReadyPromptPrefix from ASCII \u003e to Unicode ‚ùØ (U+276F)","dependencies":[{"issue_id":"bd-3q6.1","depends_on_id":"bd-3q6","type":"parent-child","created_at":"2026-01-20T03:46:15.038526338Z","created_by":"mayor"}]}
{"id":"bd-3q6.10","title":"Auto-import fails: invalid issue type 'merge-request'","description":"Auto-import shows: 'validation failed for issue: invalid issue type: merge-request'. MR beads created with issue_type='merge-request' which isn't a valid type. Should use 'task' with gt:merge-request label instead.","status":"open","priority":2,"issue_type":"bug","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T03:47:45.79661679Z","created_by":"mayor","updated_at":"2026-01-20T03:47:45.79661679Z","dependencies":[{"issue_id":"bd-3q6.10","depends_on_id":"bd-3q6","type":"parent-child","created_at":"2026-01-20T03:47:45.798568931Z","created_by":"mayor"}]}
{"id":"bd-3q6.2","title":"Sling shows 'bead not found' error but spawns polecat anyway","description":"gt sling \u003cbead\u003e beads --create shows 'Error: checking bead status: bead not found' but the polecat is spawned and working. Race condition between DB check and spawn.","status":"closed","priority":2,"issue_type":"bug","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T03:46:17.353440044Z","created_by":"mayor","updated_at":"2026-01-20T03:53:13.489915938Z","closed_at":"2026-01-20T03:53:13.489915938Z","close_reason":"Fixed: warn instead of error when bead check fails after polecat already spawned","dependencies":[{"issue_id":"bd-3q6.2","depends_on_id":"bd-3q6","type":"parent-child","created_at":"2026-01-20T03:46:17.354982565Z","created_by":"mayor"}]}
{"id":"bd-3q6.3","title":"Polecat worktree missing CLAUDE.md context","description":"Fresh polecat worktree has no CLAUDE.md. When gt prime is run, Claude doesn't recognize it. Context injection not working for fresh polecats. Witness had to nudge with basic instructions.","status":"closed","priority":2,"issue_type":"bug","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T03:46:19.12658267Z","created_by":"mayor","updated_at":"2026-01-20T03:56:06.846464469Z","closed_at":"2026-01-20T03:56:06.846464469Z","close_reason":"Fixed: ensure settings in account config dir when RuntimeConfigDir is set","dependencies":[{"issue_id":"bd-3q6.3","depends_on_id":"bd-3q6","type":"parent-child","created_at":"2026-01-20T03:46:19.128581293Z","created_by":"mayor"}]}
{"id":"bd-3q6.4","title":"Polecat beads DB shows 'invalid format version'","description":"bd show \u003cbead\u003e in polecat worktree fails with 'failed to load database at /home/ubuntu/gastown9/.beads/dolt/beads with error: invalid format version'. Polecat can't read work details from beads DB.","status":"closed","priority":2,"issue_type":"bug","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T03:46:29.437607603Z","created_by":"mayor","updated_at":"2026-01-22T18:00:13.327768774Z","closed_at":"2026-01-22T18:00:13.327768774Z","close_reason":"Closed","dependencies":[{"issue_id":"bd-3q6.4","depends_on_id":"bd-3q6","type":"parent-child","created_at":"2026-01-20T03:46:29.439446302Z","created_by":"mayor"}]}
{"id":"bd-3q6.5","title":"gt done times out (exit 143) but work still submitted","description":"gt done command times out after 2m with exit code 143 (SIGTERM), but the output shows work was successfully submitted. Misleading error status despite success.","status":"closed","priority":2,"issue_type":"bug","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T03:46:31.167784957Z","created_by":"mayor","updated_at":"2026-01-20T03:58:38.953751156Z","closed_at":"2026-01-20T03:58:38.953751156Z","close_reason":"Expected behavior: gt done kills session after submitting work. Claude Code reports this as timeout but work completes successfully. The exit 143 (SIGTERM) is from session termination, not a failure.","dependencies":[{"issue_id":"bd-3q6.5","depends_on_id":"bd-3q6","type":"parent-child","created_at":"2026-01-20T03:46:31.169324958Z","created_by":"mayor"}]}
{"id":"bd-3q6.6","title":"MR bead missing gt:merge-request label on creation","description":"Warning during gt done: 'MR bead missing gt:merge-request label, adding explicitly'. Label should be added automatically when MR bead is created.","status":"closed","priority":2,"issue_type":"bug","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T03:46:32.874660162Z","created_by":"mayor","updated_at":"2026-01-20T04:01:06.681878709Z","closed_at":"2026-01-20T04:01:06.681878709Z","close_reason":"Investigation: gastown passes --labels=gt:merge-request correctly. Issue may be in bd create handling or was self-corrected by Claude. Low priority - work proceeds.","dependencies":[{"issue_id":"bd-3q6.6","depends_on_id":"bd-3q6","type":"parent-child","created_at":"2026-01-20T03:46:32.876580303Z","created_by":"mayor"}]}
{"id":"bd-3q6.7","title":"Agent bead not found when updating active_mr","description":"Warning during gt done: 'could not update agent bead with active_mr: issue not found'. Agent bead bd-beads-polecat-onyx may not exist or has wrong ID format.","status":"closed","priority":2,"issue_type":"bug","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T03:46:44.124336087Z","created_by":"mayor","updated_at":"2026-01-20T04:01:09.537064964Z","closed_at":"2026-01-20T04:01:09.537064964Z","close_reason":"Agent bead lookup issue - related to bd-3q6.4 (database routing). Polecat works despite warning.","dependencies":[{"issue_id":"bd-3q6.7","depends_on_id":"bd-3q6","type":"parent-child","created_at":"2026-01-20T03:46:44.125835417Z","created_by":"mayor"}]}
{"id":"bd-3q6.8","title":"Refinery not auto-creating GitHub PRs","description":"With refinery not starting, PRs are not automatically created for polecat branches. Had to manually create PR using gh cli. Refinery is critical path for automated merge flow.","status":"closed","priority":2,"issue_type":"bug","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T03:46:45.571356067Z","created_by":"mayor","updated_at":"2026-01-20T04:01:12.454814792Z","closed_at":"2026-01-20T04:01:12.454814792Z","close_reason":"User clarified: GitHub PRs not needed - just merge queue items. Refinery processes merge queue, not GitHub PRs. Not a bug.","dependencies":[{"issue_id":"bd-3q6.8","depends_on_id":"bd-3q6","type":"parent-child","created_at":"2026-01-20T03:46:45.573023131Z","created_by":"mayor"}]}
{"id":"bd-3q6.9","title":"bd import warning on git pull after merge","description":"After git pull of merged PR, warning: 'Failed to import bd changes after merge. Run bd import -i .beads/issues.jsonl manually'. Auto-import after merge not working.","status":"open","priority":2,"issue_type":"bug","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T03:46:47.504663408Z","created_by":"mayor","updated_at":"2026-01-20T03:46:47.504663408Z","dependencies":[{"issue_id":"bd-3q6.9","depends_on_id":"bd-3q6","type":"parent-child","created_at":"2026-01-20T03:46:47.506342773Z","created_by":"mayor"}]}
{"id":"bd-48h","title":"Verify JSONL export is fully disabled in dolt-native mode","description":"## Goal\nEnsure JSONL export is completely disabled when sync.mode=dolt-native.\n\n## Background\nIn dolt-native mode, Dolt is the source of truth and JSONL files should not be created/updated. The `ShouldExportJSONL()` function already returns false for dolt-native mode, but need to verify:\n\n1. `bd sync` doesn't write to issues.jsonl in dolt-native mode\n2. Auto-flush doesn't export JSONL in dolt-native mode\n3. Pre-commit hook doesn't export JSONL in dolt-native mode\n4. Daemon export functions respect dolt-native mode\n\n## Verification Steps\n1. Set sync.mode=dolt-native\n2. Create/modify a bead\n3. Run bd sync\n4. Verify issues.jsonl was NOT modified\n\n## Related\n- bd-epy: ensureStoreActive ignores backend config","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T19:45:55.469301366Z","created_by":"beads/crew/upstream_syncer","updated_at":"2026-01-20T19:45:55.469301366Z","dependencies":[{"issue_id":"bd-48h","depends_on_id":"bd-dsw","type":"relates","created_at":"2026-01-22T00:56:08.130064323Z","created_by":"beads/polecats/onyx"}]}
{"id":"bd-dsw","title":"[BUG] Multiple commands fail with Dolt backend due to SQLite type assertions","description":"## Summary\nMultiple bd commands fail when using the Dolt storage backend because they type-assert to `*sqlite.SQLiteStorage` instead of using the `storage.Storage` interface. This prevents core wisp/molecule operations from working in Dolt-native deployments.\n\n## Affected Commands (need fix)\n\n### Already Fixed\n- **mol burn** - Fixed in hq-094106: now uses storage.Storage interface\n\n### Still Broken (same pattern as burn)\n1. **wisp gc** (wisp.go:641) - Uses DeleteIssue via type assertion\n2. **mol squash** (mol_squash.go:298) - deleteWispChildren uses DeleteIssue via type assertion\n\n### Partially Broken (have fallback but limited)\n3. **delete** (delete.go:437) - Has fallback but cascade not supported for non-SQLite\n\n### Need Analysis (may be legitimately SQLite-only)\n4. **compact** (compact.go) - Multiple type assertions, AI-powered feature\n5. **cook** (cook.go:787) - Formula cooking\n6. **import** (importer.go) - JSONL import (may be SQLite-workflow specific)\n7. **migrate-issues** (migrate_issues.go:160) - Hash ID migration\n8. **show** (show.go:133,363,446,718,927) - Various SQLite-specific queries\n9. **show-thread** (show_thread.go:233) - Thread display\n10. **gate wait** (server_issues_epics.go:2342) - Async gate waiting\n\n## Fix Pattern\nFor commands that use standard Storage interface methods (GetIssue, DeleteIssue, etc.):\n1. Change function signature to accept `storage.Storage` instead of `interface{}`\n2. Use interface methods directly instead of type-asserting to SQLiteStorage\n3. Remove SQLite import if no longer needed\n\n## Priority\nP1 - Core wisp operations (burn, gc, squash) are broken in Dolt mode, affecting witness patrol workflows.\n\n## Related\n- hq-094106: Fixed burn operation (merged)\n- bd-epy: ensureStoreActive ignores backend config\n- bd-48h: Verify JSONL export disabled in dolt-native mode","status":"open","priority":2,"issue_type":"bug","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-22T00:56:01.838136131Z","created_by":"beads/polecats/onyx","updated_at":"2026-01-22T00:56:01.838136131Z"}
{"id":"bd-dsw.1","title":"Fix wisp gc for Dolt: use storage.Storage interface","description":"wisp.go:641 - Change runWispGC to use storage.Storage interface for DeleteIssue instead of type-asserting to SQLiteStorage. Same fix pattern as burn (hq-094106).","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-22T00:56:14.570805764Z","created_by":"beads/polecats/onyx","updated_at":"2026-01-22T00:56:14.570805764Z","dependencies":[{"issue_id":"bd-dsw.1","depends_on_id":"bd-dsw","type":"parent-child","created_at":"2026-01-22T00:56:14.572415927Z","created_by":"beads/polecats/onyx"}]}
{"id":"bd-dsw.2","title":"Fix mol squash for Dolt: use storage.Storage interface","description":"mol_squash.go:298 - Change deleteWispChildren to use storage.Storage interface for DeleteIssue instead of type-asserting to SQLiteStorage. Same fix pattern as burn (hq-094106).","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-22T00:56:19.889055086Z","created_by":"beads/polecats/onyx","updated_at":"2026-01-22T00:56:19.889055086Z","dependencies":[{"issue_id":"bd-dsw.2","depends_on_id":"bd-dsw","type":"parent-child","created_at":"2026-01-22T00:56:19.890649458Z","created_by":"beads/polecats/onyx"}]}
{"id":"bd-dsw.3","title":"Audit show/delete commands for Dolt compatibility","description":"Multiple type assertions in show.go and delete.go may need review:\n- show.go:133,363,446,718,927 - Various SQLite-specific queries\n- show_thread.go:233 - Thread display\n- delete.go:437 - Has fallback but cascade not supported\n\nDetermine which assertions are using SQLite-specific features vs standard interface methods.","status":"open","priority":2,"issue_type":"task","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-22T00:56:26.650326249Z","created_by":"beads/polecats/onyx","updated_at":"2026-01-22T00:56:26.650326249Z","dependencies":[{"issue_id":"bd-dsw.3","depends_on_id":"bd-dsw","type":"parent-child","created_at":"2026-01-22T00:56:26.65188926Z","created_by":"beads/polecats/onyx"}]}
{"id":"bd-epy","title":"ensureStoreActive ignores backend config, breaks Dolt mode","description":"## Problem\n`ensureStoreActive()` in `cmd/bd/direct_mode.go:92` hardcodes `sqlite.New(path)` instead of using the factory to respect backend configuration.\n\nWhen backend is Dolt:\n- `FindDatabasePath()` correctly returns the dolt directory path\n- But `ensureStoreActive()` passes this path to `sqlite.New()`\n- SQLite tries to open the directory as a file and fails\n\n## Error\n```\nError: failed to initialize direct mode: failed to open database: failed to enable WAL mode: sqlite3: unable to open database file: open /home/ubuntu/gastown9/.beads/dolt: is a directory\n```\n\n## Fix\nReplace:\n```go\nsqlStore, err := sqlite.New(getRootContext(), path)\n```\n\nWith factory usage that respects backend config:\n```go\nbeadsDir := filepath.Dir(path)\nstore, err := factory.NewFromConfig(getRootContext(), beadsDir)\n```","status":"open","priority":1,"issue_type":"bug","owner":"matthew.baker@pihealth.ai","created_at":"2026-01-20T19:45:46.076021217Z","created_by":"beads/crew/upstream_syncer","updated_at":"2026-01-20T19:45:46.076021217Z","dependencies":[{"issue_id":"bd-epy","depends_on_id":"bd-dsw","type":"relates","created_at":"2026-01-22T00:56:07.976341212Z","created_by":"beads/polecats/onyx"}]}
{"id":"bd-igt","title":"Digest: mol-refinery-patrol","description":"Patrol complete: Queue empty at start, no branches to merge. Inbox clean (0 messages). No issues filed. Context at 17%.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-22T07:34:39.399611604Z","updated_at":"2026-01-22T07:34:39.399611604Z","closed_at":"2026-01-22T07:34:39.399512131Z","close_reason":"Squashed from 11 wisps","dependencies":[{"issue_id":"bd-igt","depends_on_id":"bd-wisp-291","type":"parent-child","created_at":"2026-01-22T07:34:39.400826036Z","created_by":"beads/refinery"}]}
{"id":"bd-ufu","title":"Digest: mol-refinery-patrol","description":"Patrol: queue empty, no merges, handoff archived","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-22T07:40:22.877982946Z","updated_at":"2026-01-22T07:40:22.877982946Z","closed_at":"2026-01-22T07:40:22.877863273Z","close_reason":"Squashed from 11 wisps","dependencies":[{"issue_id":"bd-ufu","depends_on_id":"bd-wisp-9u8","type":"parent-child","created_at":"2026-01-22T07:40:22.879324841Z","created_by":"beads/refinery"}]}
