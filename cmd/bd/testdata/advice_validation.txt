# Test bd advice validation and error cases
bd init --prefix test

# Test 1: Title is required
! bd advice add
stderr 'title'

# Test 2: Hook command requires trigger
! bd advice add 'Hook without trigger' --hook-command 'make test'
stderr 'requires --hook-trigger'

# Test 3: Invalid hook trigger
! bd advice add 'Bad trigger' --hook-command 'make test' --hook-trigger invalid
stderr 'invalid --hook-trigger'

# Test 4: Valid global advice works
bd advice add 'Valid global' -d 'Description'
stdout 'Created advice:'

# Test 5: Valid rig advice works
bd advice add 'Valid rig' --rig testrig -d 'Description'
stdout 'Created advice:'
stdout 'rig:testrig'

# Test 6: Valid role advice works
bd advice add 'Valid role' --role polecat -d 'Description'
stdout 'Created advice:'
stdout 'role:polecat'

# Test 7: Valid agent advice works
bd advice add 'Valid agent' --agent testrig/polecats/alpha -d 'Description'
stdout 'Created advice:'
stdout 'agent:testrig/polecats/alpha'

# Test 8: Multiple targeting flags can be combined
bd advice add 'Combined targeting' --rig testrig --role polecat --agent testrig/polecats/alpha
stdout 'Created advice:'
stdout 'rig:testrig'
stdout 'role:polecat'
stdout 'agent:testrig/polecats/alpha'
